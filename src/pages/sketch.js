const width = document.documentElement.scrollWidth;
const height = document.documentElement.scrollHeight;

const workingWidth = width * 0.9;
const workingHeight = height * 0.9;

let dataset = {
    class1: [[-0.46767551023127496, 1.093505885418756], [0.326731182114003, -1.3486376948207086], [-3.7301709774417975, 1.3698772818538323], [1.6905955889577484, -2.2711398429453236], [2.4589366244065367, -0.644840404509522], [3.946920835895728, 0.9027333749337931], [-0.5038224224133675, 1.85660676483847], [0.16669225015124473, 0.19372687185527349], [0.114191418323006, -0.23269223783791798], [0.9513380147518868, 1.2159825051391044], [0.532212913458501, 2.7188854707150387], [-2.034713706418065, -0.6954479488370009], [1.2369807669660946, -1.7646472206256636], [2.346734489374162, 1.0690576418029272], [-0.27150989679339205, 0.8012992883804847], [-0.8799194397273937, -2.2227799031827984], [1.2858714276559693, 1.414648481059805], [0.17166215140344665, -0.03293502539035113], [-3.1907168197619415, -1.251611202307415], [-0.6982624649234697, 0.3505658861489089], [2.0775528389424602, -0.7794406300111927], [-1.170228207934343, 1.4334143858302109], [-0.19010456703457032, -2.052919234985209], [1.8277209689040652, -1.2862521574199934], [-0.8422063146752565, -1.5502798490939442], [0.5381564336203226, 1.6105220130032607], [-0.5632570866504252, 0.5945513595904459], [-0.7071694152793302, 3.5049117182628766], [2.2541782967065087, -0.8931895784692345], [0.7925115847540397, 1.4097371963731007], [0.6394280800909417, -1.1372355452221465], [-0.24355046475053888, 1.0902149413372941], [0.666124453364434, -1.285233958770658], [0.6703926367343584, -1.521971980227396], [-3.198485095208955, 0.2607946019703896], [1.4268018827016582, 0.6628460806967404], [2.2035260899806453, 2.624274526395618], [0.530295932488164, -0.9650059388408023], [-0.07085558088357197, -2.1735596797203716], [-0.054284648691839875, -0.1362704787609439], [0.26443550990256304, 1.6419306217332386], [-3.1897118844375028, 1.1271732485719972], [-0.8109105657147433, 1.189833533668779], [0.26048002180413915, -1.553151428946843], [1.3114025851184976, -1.1093581156680936], [0.7844180299133003, -0.887814721704989], [-0.7162306590071497, 0.16879451465876155], [2.8571134840256613, 1.0412297191958249], [-0.029372007278032047, 2.4942642784470914], [0.04591264324623807, -0.4462488088011181], [-1.4522064544742987, 0.2506000959847634], [0.17490294824984365, -1.0233859867016581], [-2.871031725768276, -0.20985347213775057], [0.17238688029448843, -0.5925069621054384], [-1.4299743967469594, -1.609241033330195], [-0.7266684081390589, 2.0444067829637715], [0.22903165519141064, -2.4489308970185064], [0.9649521688711823, -0.6718425719856774], [3.5085513420979804, -0.46998429716827095], [-0.08942634458371705, 0.29125249781281287], [0.43031894769703544, 0.07778953908642314], [0.0773264165105764, -0.32938088130420545], [-0.8298847467199832, -0.5608663048174571], [-1.7766252878921092, -0.7922597668175381], [-0.9953008312528298, -0.6506047258481206], [-0.6678661114717582, -0.21293883890535945], [0.6786014138555162, -0.464193848960499], [0.1361954459096819, 0.40539988353263334], [-0.47173774011274405, -0.21746336541091899], [0.5330558465565853, -2.54837938155591]],
    class2: [[1.32862878479857, 1.763812185229405], [-0.8451178289469086, 2.266920791519374], [0.39932430273519826, 2.44582636652444], [0.5076360347801738, 1.894686513460823], [1.3330789621199328, 1.601875875826999], [0.5022900878142753, 1.9429364201253074], [1.6850907616424347, 2.5498266699477363], [1.700290728436022, 2.192354022240224], [1.2441420572763784, 2.5351548654799663], [1.2842767012413174, 1.5975172137095588], [1.3913151934696066, 1.7532907291925863], [0.5900570192034139, 2.0693568443778068], [0.9601371755298469, 2.4363327435636393], [1.1392584009011695, 1.786229933712084], [0.969953696719504, 1.7157558542473306], [0.8381705148955175, 2.6330516856528994], [1.206781671557027, 1.8133116053451757], [0.8399168530913246, 1.7034020822504885], [0.9061712726227925, 1.2568039519363583], [1.305947207910497, 1.865077968164874], [1.3462465527637963, 2.4806666628547713], [1.1575428192841914, 1.492667248467353], [0.388712142006714, 2.4114062975358794], [1.4182374251275682, 1.3109528114525792], [0.5272855965326817, 2.545643236107022], [1.0370488663071216, 3.015380174560931], [1.2584473529712907, 2.4644286815109333], [0.9579144936951707, 1.775717151155873], [0.2750360362057337, 0.646534605087351], [1.5578468889182489, 2.3970516287727928], [0.7478665087435653, 2.5262549668043923], [0.26647330648302336, 2.7870520788737814], [1.236168691927214, 2.83846502052582], [0.15439454834129174, 2.7139037204372727], [1.4642802290664192, 2.16973505325969], [0.5656089730357003, 2.177418831625823], [1.131404399005993, 1.6954826047850302], [0.3144739547617895, 1.4656876126180975], [0.7346496392236894, 2.5684711347228397], [1.5935290939156541, 2.8454479143305345], [1.2451406827407523, 1.2772349081703687], [0.6284495951926727, 1.4229777913328145], [0.871162965902406, 2.6884070217607308], [0.9105096341886334, 1.7846850430607282], [1.264536236580189, 2.366682065499834], [1.483357925208074, 1.5323629489510682], [0.5608958678170861, 1.7721358697994944], [1.3715379531326148, 2.0966489207679655], [0.5143383289217027, 2.9484360921674804], [0.7283480254897087, 1.9381026596610103], [0.9517105767759412, 1.5899926966039353], [0.9822116371307071, 2.0281752032143454], [1.1309940615812224, 2.157786114873005], [0.7336048278090608, 1.5373487840638458], [1.546959887159194, 1.8909916506278124], [1.548868796714733, 2.2267097945011534], [2.341397635066177, 1.9520460392849295], [0.17291238862128477, 1.842308011999617], [1.6058229744164336, 2.9505887653716503], [1.8754040921996014, 2.334461700191147], [1.80186204164431, 1.510071491916581], [0.7243877650068065, 1.5444901195822867], [1.3106986315223985, 2.6662651624168685], [1.0351796718937296, 2.2259108930300027], [0.7890989599111726, 1.8349940886557392], [1.0820453655492561, 2.7921515897019082], [1.2586431263688744, 2.2793657886444585], [1.5593143640569822, 2.34391916560996], [0.662143812678263, 2.8923378541050075], [0.9543419883607501, 2.03058657536788]],
}

const radius = 8;

let logorythmScale = 1;

export const sketch = p5 => {
    p5.setup = () => {
        p5.createCanvas(width, height);
        mapDataset(dataset, false);
    }

    p5.draw = () => {
        p5.background(255);
        drawDataset(dataset.class1, [255, 0, 0]);
        drawDataset(dataset.class2, [0, 255, 0]);
    }

    function drawDataset(dataset, color) {
        for (let e of dataset) {
            p5.fill(color);
            p5.ellipse(p5.map(e[0], -4, 4, 0, width),
                p5.map(e[1], -3, 4, 0, height),
                radius, radius);
        }
    }

    function mapDataset(dataset, islogorythm, ...logorythmScale) {
        let mappedClass1 = [], mappedClass2 = [];
        if (islogorythm) {

        } else {
            let extraData = minMaxDataset(dataset);
            for (let e of dataset.class1) {
                mappedClass1.push([
                    p5.map(e[0], extraData.minX, extraData.maxX,
                        0, workingWidth),
                    p5.map(e[1], extraData.minY, extraData.maxY,
                        0, workingHeight)
                ]);
            }
            for (let e of dataset.class2) {
                mappedClass2.push([
                    p5.map(e[0], extraData.minX, extraData.maxX,
                        0, workingWidth),
                    p5.map(e[1], extraData.minY, extraData.maxY,
                        0, workingHeight)
                ]);
            }
        }
        return {
            class1: mappedClass1,
            class2: mappedClass2,
        }

        function minMaxDataset(dataset) {
            let minX = 2000000000, maxX = -2000000000;
            let minY = 2000000000, maxY = -2000000000;
            for (let e of dataset.class1.concat(dataset.class2)) {
                if (e[0] < minX) {
                    minX = e[0];
                }
                if (e[0] > maxX) {
                    maxX = e[0];
                }
                if (e[1] < minY) {
                    minY = e[1];
                }
                if (e[1] > maxY) {
                    maxY = e[1];
                }
            }
            return dataset.length === 0
                ? undefined
                : {
                    minX: minX, maxX: maxX,
                    minY: minY, maxY: maxY
                };
        }
    }
};

export function changeLogorythmScale(param) {
    console.log(param);
    logorythmScale = param;
}